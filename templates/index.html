$def with ()

<!doctype html>
<html>
	<head>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
		<script type="text/javascript" src="/static/jquery.plugin.js"></script>
		<script type="text/javascript" src="/static/jquery.timer.js"></script>
		<script type="text/javascript">
			jQuery(document).ready(function() {
				jQuery("button").click(function() {
					//Init of the timer, the timer called by the first Ajax request, see below
					//The timer asks regulary the server for a status update, receveing the total
					//amount, the counter and a statusfield. As soon as the statusfield reaches 1
					//the requests are stopped and the final page is displayed.
					jQuery("div").timer({
						delay: 100,
						repeat: true,
						autostart: false,
						callback: function(index) { //console.log ("Debug: Timer Started");
							//console.log ("Debug: Repeating AjaxCall requesting count");
							jQuery.getJSON("http://dscript.ziknet.ch/count")
							.done(function(response) {
								//console.log ("Debug: AJAX - Received JSON");
								jQuery("div").html(response.count + "/" + response.total + " - Status: " + response.status);
								if (response.status == 1) {
									jQuery("div").timer('stop');
									alert("Load Final Page?");
									jQuery("div").load("http://dscript.ziknet.ch:/static/datafileFinalCall");
								}
							});
						}	
					});
					//Causes the timer to be reset
					//If not there would only be one run as the timer will have reached its limit (if manual repeat of 15 for example)
					jQuery("div").timer('stop');
					//First Ajax request - Run the script 
					jQuery.ajax({url: "http://dscript.ziknet.ch/runscript"})
					.done(function(response) {
						//console.log("Debug: AJAX - Script has been started successfully");
						//console.log("Debug: Starting Timer");
						//Clause which handles the procedure if the script is already running
						if (response == 0) {
							jQuery("div").html("<h1><b>The Script is already running!!! </b></h1> Please try again later...");
							jQuery("button").remove();
						}
						else {
							jQuery("div").timer('start');
						}
					});
					
				});
			});
		</script>
	</head>
	<body>
		<button>Click Me</button>
		<br><br>
		<div></div>
	</body>
</html>
