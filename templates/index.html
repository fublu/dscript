$def with ()

<!doctype html>
<html>
	<head>
		<style type="text/css">	
		#body {
			margin:75px 0pt 0px;
		}
		#layout {
			font-family:arial;
			font-size: 10pt;
			text-align: center;
			margin-left: auto;
			margin-right: auto;
			table-layout: fixed;
		}
		#status {
			font-family:arial;
			font-size: 10pt;
			padding-top:5px;
			text-align: center;
			color: LightSlayGray;
		}
		#impressum {
			font-family:arial;
			font-size: 7pt;
			padding-top:12px;
			text-align: center;
			color: SlateGray;
			font-style: italic;
		}
		a:link {color:Blue;}
		a:visited {color:Blue;}
			
		</style>
			
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
		<script type="text/javascript" src="/static/jquery.plugin.js"></script>
		<script type="text/javascript" src="/static/jquery.timer.js"></script>
		<script type="text/javascript">
			jQuery(document).ready(function() {
				
				jQuery.getJSON("http://dscript.ziknet.ch/counter")
				.done(function(response) {
					//checks automatically if the script is already running,
					//if so it will disable the input fields			
					if (response.RUN_STATE == 1) {
						jQuery("#status").html("<b>Die Applikation wird bereits ausgef체hrt</b><br>Bitte versuchen Sie es sp채ter nochmals...<br>Stand: " + response.CM_COUNT + "/" + response.CM_TOTAL);
						jQuery("button").attr('disabled', 'disabled');
						jQuery("select").attr('disabled', 'disabled');
					}
				});
				
				jQuery("button").click(function() {
					//Init of the timer, the timer called by the first Ajax request, see below
					//The timer asks regulary the server for a status update, receveing the total
					//amount, the counter and a statusfield. As soon as the statusfield reaches 1
					//the requests are stopped and the final page is displayed.				
					jQuery("#status").timer({
						delay: 1000,
						repeat: true,
						autostart: false,
						callback: function(index) { //console.log ("Debug: Timer Started");
							//console.log ("Debug: Repeating AjaxCall requesting count");
							jQuery.getJSON("http://dscript.ziknet.ch/counter")
							.done(function(response) {
								//console.log ("Debug: AJAX - Received JSON");
								//jQuery("#status").html(response.CM_COUNT + "/" + response.CM_TOTAL + " - Status: " + response.RUN_STATE);
								jQuery("#status").html(response.CM_COUNT + "/" + response.CM_TOTAL);
								if (response.RUN_STATE == 0) {
									jQuery("#status").timer('stop');
									jQuery("#result").load("http://dscript.ziknet.ch/static/result.html");
								}
							});
						}	
					});
					//Stopping the timer causes the timer to be reset
					//If not there would only be one run as the timer will have reached its limit (if manual repeat of 15 for example)
					jQuery("#status").timer('stop');
					
					//Getting the selected value (ex 5/1/0)
					var macdomain = jQuery("select").val();
					
					//First Ajax request - Run the script 
					jQuery.ajax({url: "http://dscript.ziknet.ch/runscript", data: {macdomain: macdomain}}) // {description:var}
					.done(function(response) {
						//console.log("Debug: AJAX - Script has been started successfully");
						//console.log("Debug: Starting Timer");
						//Clause which handles the procedure if the script is already running
						//Just in case the script wasn't running at the time the page was loaded, however started in the meantime
						if (response == 1) {
							jQuery("#status").html("<b>Die Applikation wird bereits ausgef체hrt</b><br>Bitte versuchen Sie es sp채ter nochmals...<br>Stand: " + response.CM_COUNT + "/" + response.CM_TOTAL);
							//jQuery("button").remove();
							jQuery("button").attr('disabled', 'disabled');
							jQuery("select").attr('disabled', 'disabled');
						}
						else {
							jQuery("#status").timer('start');
							jQuery("#status").html("Abfrage wird initialisiert...");
							jQuery("button").attr('disabled', 'disabled');
							jQuery("select").attr('disabled', 'disabled');
						}
					});
				});
			});
		</script>
	</head>
	<body id="body">		
		<table id="layout">
			<tr>
				<td colspadn="2">
					<select>
						<option value="5/0/0">C5/0/0</option>     
						<option value="5/0/1">C5/0/1</option>     
						<option value="5/0/2">C5/0/2</option>     
						<option value="5/0/3">C5/0/3</option>        
						<option value="5/0/4">C5/0/4</option>           
						<option value="5/1/0">C5/1/0</option>            
						<option value="5/1/1">C5/1/1</option>            
						<option value="5/1/2">C5/1/2</option>            
						<option value="5/1/3">C5/1/3</option>            
						<option value="5/1/4">C5/1/4</option>            
						<option value="6/1/0">C6/1/0</option>            
						<option value="6/1/1">C6/1/1</option>                
						<option value="6/1/2">C6/1/2</option>             
						<option value="6/1/3">C6/1/3</option>           
						<option value="6/1/4">C6/1/4</option>
					</select>
					<button>Go</button>
				</td>
			</tr>
			<tr>
				<td colspan="2"><div id="status"><a href="/static/result.html">Letzte Abfrage</div></td>
			</tr>
		</table>
		<div id="impressum"> Developed by Teletrend AG (JM) for Technische Betriebe Suhr - Version 0.2 (05.2013)</div>
		<div id="result"></div>
	</body>
</html>

 